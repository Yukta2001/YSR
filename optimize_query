SELECT ahc.hc_id,
(P.FIRST_NAME || ' ' || P.MIDDLE_NAME || ' ' || P.LAST_NAME) PATIENT_NAME,
P.RATION_CARD_NO,
(SELECT AL.LOC_NAME FROM ASRIM_LOCATIONS AL WHERE AL.LOC_ID = P.DISTRICT_CODE AND AL.LOC_HDR_ID = 'LH6' ) DISTRICT_NAME,
(SELECT AL.LOC_NAME FROM ASRIM_LOCATIONS AL WHERE AL.LOC_ID = P.mandal_code) Mandal,
(SELECT AL.LOC_NAME FROM ASRIM_LOCATIONS AL WHERE AL.LOC_ID = P.village_code) Village,
(SELECT AL.LOC_NAME FROM ASRIM_LOCATIONS AL WHERE AL.LOC_ID = P.hamlet_code) Hamlet,
ah.hosp_id ref_hosp_id,
AH.HOSP_NAME ref_HOSP_NAME,
ahd.loc_name hosp_dist_name,
p.patient_id,
P.PATIENT_IPOP,
c.CASE_ID,
DISEASE.DIS_MAIN_NAME Category_Name,
DISEASE.DIS_MAIN_ID Category_Code,
SURG.surgery_id Surg_Code,
SURG.surgery_desc Surg_Name,
P.CRT_DT Ref_entry_dt,
P.Reg_Hosp_Date Reported_Dt,
cmb.cmb_dtl_name case_status,
case
when (SELECT group_id FROM Asrim_Case_Status_Grp CSG WHERE CSG.status_id = C.CASE_STATUS) = 'CD17' AND CSP.CASE_APPRV_REJ_DT IS NOT NULL then
    DECODE(b.CASE_CMO_APRV_AMT, NULL, 
    DECODE(b.CASE_CEO_APRV_AMT, NULL, b.CASE_TRUST_APRV_AMT, 0, b.CASE_TRUST_APRV_AMT, b.CASE_CEO_APRV_AMT), b.CASE_CMO_APRV_AMT)
end as pre_auth_appr_amt,
c.lst_upd_dt Status_Dt,
ahc.hc_date,
(SELECT al.loc_val FROM ASRIM_LOCATIONS AL WHERE AL.LOC_ID = P.DISTRICT_CODE AND AL.LOC_HDR_ID = 'LH6') loc_val
FROM ASRIT_PATIENT P 
JOIN asrim_hc ahc ON ahc.hc_id = p.src_hc_id
LEFT JOIN asrim_hospitals ah ON AH.HOSP_ID = p.REF_HOSP_NO
LEFT JOIN asrim_locations ahd ON ahd.loc_id = ah.hosp_dist_cd
JOIN ASRIT_CASE C ON p.patient_id = c.case_patient_no
LEFT JOIN ASRIT_CASE_SURGERY ACS ON ACS.CASE_ID  = C.CASE_ID
LEFT JOIN ASRIM_SURGERY SURG ON SURG.SURGERY_ID = ACS.SURGERY_CODE AND SURG.DIS_MAIN_ID = ACS.DIS_MAIN_CODE
LEFT JOIN ASRIM_DISEASE_MAIN DISEASE ON DISEASE.DIS_MAIN_ID = ACS.DIS_MAIN_CODE
LEFT JOIN ASRIT_CASE_PROCES CSP ON CSP.CASE_ID = C.CASE_ID
LEFT JOIN ASRIT_CASE_CLAIM b ON b.CASE_ID = C.CASE_ID
LEFT JOIN asrim_combo cmb ON c.case_status = cmb.cmb_dtl_id
WHERE P.SRC_REGISTRATION = 'MC';
