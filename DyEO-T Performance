WITH mq as
(SELECT 
a.CASE_ID,
a.CASE_STATUS,
b.cmb_dtl_name
FROM ASRIT_CASE a
LEFT JOIN ASRIM_COMBO b ON a.CASE_STATUS = b.cmb_dtl_id
WHERE a.CRT_DT BETWEEN '19-SEP-23' AND '10-FEB-24')
SELECT ac.CASE_ID,au.USER_ID,au.LOGIN_NAME,
au.FIRST_NAME||' '||AU.LAST_NAME as user_name,
au.LST_UPD_DT,ac.ACT_ID,ab.cmb_dtl_name AS ACTION_TAKEN,mq.cmb_dtl_name AS PRESENT_STATUS
FROM ASRIT_AUDIT ac
LEFT JOIN ASRIM_USERS au ON ac.ACT_BY = au.USER_ID
LEFT JOIN ASRIM_COMBO ab ON ac.ACT_ID = ab.cmb_dtl_id
JOIN mq ON mq.CASE_ID=ac.CASE_ID
WHERE au.USER_ROLE IN ('CD212','CD15634','CD7')
AND ac.CRT_DT BETWEEN '19-SEP-23' AND '10-FEB-24'
